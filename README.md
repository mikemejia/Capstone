# Capstone


## Problem Statement:

Strategy and skill are major components in Formula 1. Although most fans see the skill that drivers demonstrate in races, few observe the strategy that teams implement during their races. The best startegy involves the right planning of pit stops and what tires should be used and which tires should be replaced afterwards. Although there is a lot of engineering put into the F1 cars there are still a few variables that can put some lesser cars in the front of the pack. As there are no limits to pit stops and each pit stop removes time from every lap completed, this can affect a drivers position in the race. A car already being in the back of the pack has to plan effectivily if they hope to gain position. With data collecting and modeling I will determine the best race strategy during a race. All of this depends mostly on tire selection, tire wear, and lap times. The less grip a car has the slower its pace. But with different race tires some might have less grip which give a slower pace but have a longer life that can help delay the need for a pitstop.

## Data collection:

The majority of the data was collected from the formula one race data from Kaggle. It includes 13 different tables that vary from what circuits are included in that season, to lap times, drivers, and results. The kaggle data was gathered using "Ergast" which is an api that queries historical data for the formula one series from 1950 to the present. The other part of data collecting was the tire data which was not included in the kaggle website or the Ergast Api. This information was available through "racefans.net" which did have the class of tyres used during a race and during the season. 
## Parsing Data:

Once all the data had been collected I created an sql server on my personal computer. Creating a database that would hold all my tables I would then need to create each table specifying which datatypes each column would be and which column would be the primary key if it needed it. Although creating the table and the database could be done in Terminal, I would find it more useful to implement pymysql. PyMySQL are database connectors which allows python programs to communicate with them. I would write the sql syntax as I normally would make that into a string which I could then send through PyMySQL to my server which would then run the command. As said before this could be easily done on the terminal but this became useful when inserting data into the tables. 
## Data cleaning

The data had been cleaned already there were missiong values in some rows of the tables. Most Nans were found during qualifying or during races. The reason for these appearences was that some cars didnt qualify for the next round of qualifications or during a race a crash occured which meant the car could not complete all laps. I decided what features I believed would be important for the modeling process. These included several tables that would need to be combined. I believed that the lap times would be important to predict when a car should be pitting. The other features were the year the race took place, the amount of laps for a race, circuit id, and the position on the track. 
## Modeling

I started with a simple logistic regression. I got a 98% accuracy score for that model. Job done I thought but I realized that it wasnt predicting anything. the baseline score was 98% which is very unbalanced. So I began to use a different metric for accuracy. I chose sensitivity as I wanted the true positive which was only 2% of the data to be what I was modeling for. Attempting different methods/models and the sensitivity was not getting any higher. I attempted neural networds but was unable raise that score at all. The problem was that most races did not run with the same circumstances. The model cannot predict a crash and yet theres a good chance a car will recieve damage on the first lap requiring it to get a pitstop. These crashes can skew the data if it happens regularly. 

A decision tree helped in raising the senetivity to 30%. The still isnt a great score but I find it to be a better improvement then the other models. 
## Conclusions

The overall project demonstrated that its not easy to predict a topic where certain events can change the entire output of a races stats or how a teams points standing can effect how they drive during the season. Though the model was not predicting the values from the train test split. I do believe it was giving out of the data it trained from the better pit strategy for that particular car. But there are other factors that are outside of the models scope. Such as only one car from a team can pit at a time meaning every team has two cars and one car will have to wait for the other pit in order for their car to go afterwards. I would have liked to include the tire data that was collected but the small amount of data which was has only been recorded from the past few years, was not enough to improve the modeling. 